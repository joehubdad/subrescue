[gd_scene load_steps=4 format=2]

[sub_resource type="Shader" id=1]
code = "shader_type particles;

uniform int amount : hint_range(1, 1000) = 8;

uniform float max_rope_distance : hint_range(1.0, 1000.0) = 20.0;
uniform float scale : hint_range(0.0, 10.0) = 1.0;

uniform vec3 start = vec3(-5.0, 5.0, 0.0);
uniform vec3 end = vec3(5.0, 5.0, 0.0);
uniform vec3 curve_direction = vec3(0.0, -1.0, 0.0);

uniform vec4 color : hint_color = vec4(1.0);

uniform sampler2D color_gradient : hint_white;

void vertex() {
	float new_index = float(INDEX) / float(amount - 1);
	
	TRANSFORM[0].x = scale;
	TRANSFORM[1].y = scale;
	TRANSFORM[2].z = scale;
	TRANSFORM[3].xyz = mix(start, end, new_index) - curve_direction * (new_index * new_index - new_index) * 4.0 * max((max_rope_distance - distance(start, end)) * 0.5, 0.0);
	
	COLOR.rgb = texture(color_gradient, vec2(new_index, 0.0)).rgb * color.rgb;
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )
shader_param/amount = 8
shader_param/max_rope_distance = 20.0
shader_param/scale = 1.0
shader_param/start = Vector3( 5, 25, 0 )
shader_param/end = Vector3( 55, 25, 0 )
shader_param/curve_direction = Vector3( 0, -1, 0 )
shader_param/color = Color( 0.0431373, 0.0352941, 0.968627, 1 )

[sub_resource type="ParticlesMaterial" id=3]
flag_disable_z = true
gravity = Vector3( 0, 98, 0 )
orbit_velocity = 0.0
orbit_velocity_random = 0.0

[node name="Particles2D" type="Particles2D"]
material = SubResource( 2 )
explosiveness = 1.0
process_material = SubResource( 3 )
